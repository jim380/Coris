<section>
  <div class="row">
    <!-- First column -->
    <div class="col-12">
      <mdb-card class="card-1 mat-elevation-z8 mb-3">
        <mdb-card-header>
            <mdb-card-title>Transaction Detail</mdb-card-title>
        </mdb-card-header>
        <mdb-card-body>
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  Hash
                  <span class="badge badge-primary badge-pill">
                    {{tx.hash | slice:0:15 }}... 
                    <i 
                      class="ion-ios-copy copy-button" 
                      style="cursor: pointer;" 
                      ngxClipboard 
                      [cbContent]="tx.hash" 
                      (click)="onCopySucceess()"
                      mdbTooltip="copy to clipboard" mdbTooltipPosition="above">
                    </i>
                  </span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  Status
                  <span *ngIf="!tx.error; else elseStatus">
                    <i class="ion-checkmark-circled success"></i>
                  </span>
                  <ng-template #elseStatus>
                    <i class="ion-close-circled fail"></i>
                  </ng-template>
                  <!-- <span class="badge badge-primary badge-pill"></span> -->
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  Height
                  <span class="badge badge-primary badge-pill">{{tx.height}}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Timestamp
                    <span class="badge badge-primary badge-pill">{{tx.details?.timestamp | ago | async}}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  Fee
                  <span class="badge badge-primary badge-pill">
                      {{ 
                        tx.details?.tx.value.fee.amount ?
                        tx.details.tx.value.fee.amount[0].amount : '0' 
                      }} uatom
                  </span>
                </li>
                <li *ngIf="tx.gasUsed && tx.gasUsed" class="list-group-item d-flex justify-content-between align-items-center">
                  Gas (used/wanted)
                  <span class="badge badge-primary badge-pill">
                    {{ tx.gasUsed }}/{{ tx.gasWanted }}
                  </span>
                </li>
                <li *ngIf="tx.memo.length > 0" class="list-group-item d-flex justify-content-between align-items-center">
                  Memo
                  <span class="badge badge-primary badge-pill">{{ tx.memo }}</span>
                </li>
            </ul>
        </mdb-card-body>
      </mdb-card>
    </div>
    <div class="col-12">
      <mdb-card class="card-2 mat-elevation-z8 mb-3">
        <mdb-card-header>
            <mdb-card-title>Activity</mdb-card-title>
        </mdb-card-header>
        <mdb-card-body>
            <ul class="list-group">
              <span *ngFor="let action of tx.action; index as i">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  Type
                  <span class="badge badge-primary badge-pill">{{ action | titlecase}}</span>
                </li>
                
                <li *ngIf="tx.msg[i].value.from_address" class="list-group-item d-flex justify-content-between align-items-center">
                  From
                  <span 
                      class="badge badge-primary badge-pill"
                      style="cursor:pointer;" 
                      (click)="openTxsListDialog(tx.msg[i].value.from_address)">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.from_address ) : false; else elseSender">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.from_address )}}
                    </span>
                    <ng-template #elseSender>{{ tx.msg[i].value.from_address }}</ng-template>
                  </span>
                </li>
                
                <li *ngIf="tx.msg[i].value.to_address" class="list-group-item d-flex justify-content-between align-items-center">
                  To
                  <span class="badge badge-primary badge-pill"
                        style="cursor:pointer;" 
                        (click)="openTxsListDialog(tx.msg[i].value.to_address)">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.to_address ) : false; else elseRecipient">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.to_address )}}
                    </span>
                    <ng-template #elseRecipient>{{ tx.msg[i].value.to_address }}</ng-template>
                  </span>
                </li>
                
                <li *ngIf="tx.msg[i].value.delegator_address" class="list-group-item d-flex justify-content-between align-items-center">
                  Delegator
                  <span style="cursor:pointer;" 
                        (click)="openTxsListDialog(tx.msg[i].value.delegator_address)" 
                        class="badge badge-primary badge-pill">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.delegator_address ) : false; else elseDelegator">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.delegator_address )}}
                    </span>
                    <ng-template #elseDelegator>{{tx.msg[i].value.delegator_address}}</ng-template> 
                  </span>
                </li>
                
                <li *ngIf="tx.msg[i].value.validator_address" class="list-group-item d-flex justify-content-between align-items-center">
                  Validator
                  <span class="badge badge-primary badge-pill"
                        (click)="openValidatorDetailDialog( tx.msg[i].value.validator_address )"
                        style="cursor: pointer">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.validator_address ) : false; else elseValidator">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.validator_address )}}
                    </span>
                    <ng-template #elseValidator>{{tx.msg[i].value.validator_address}}</ng-template> 
                  </span>
                </li>

                <li *ngIf="tx.msg[i].value.validator_src_address" 
                    class="list-group-item d-flex justify-content-between align-items-center">
                  From
                  <span class="badge badge-primary badge-pill"
                        (click)="openValidatorDetailDialog( tx.msg[i].value.validator_src_address )"
                        style="cursor: pointer">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.validator_src_address ) : false; else elseSrcValidator">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.validator_src_address )}}
                    </span>
                    <ng-template #elseSrcValidator>{{tx.msg[i].value.validator_src_address}}</ng-template> 
                  </span>
                </li>
                
                <li *ngIf="tx.msg[i].value.validator_dst_address" 
                    class="list-group-item d-flex justify-content-between align-items-center">
                  To
                  <span class="badge badge-primary badge-pill"
                        (click)="openValidatorDetailDialog( tx.msg[i].value.validator_dst_address )"
                        style="cursor: pointer">
                    <span *ngIf="(appState | async).valsMap.size ? (appState | async).valsMap.has( tx.msg[i].value.validator_dst_address ) : false; else elseDstValidator">
                      {{ (appState | async).valsMap.get( tx.msg[i].value.validator_dst_address )}}
                    </span>
                    <ng-template #elseDstValidator>{{tx.msg[i].value.validator_dst_address}}</ng-template> 
                  </span>
                </li>


                <span *ngIf="tx.msg[i].type === 'cosmos-sdk/MsgMultiSend'">
                  <li *ngFor="let input of tx.msg[i].value.inputs" 
                      class="list-group-item d-flex justify-content-between align-items-center">
                    Sender
                    <span class="badge badge-primary badge-pill"
                          (click)="openTxsListDialog( input.address )"
                          style="cursor: pointer;"> 
                      <span *ngIf="(appState | async).valsMap.size 
                                    ? (appState | async).valsMap.has( input.address ) 
                                    : false; else elseInputMulti">
                        {{ (appState | async).valsMap.get( input.address )}}
                      </span>
                      <ng-template #elseInputMulti>{{ input.address }}</ng-template>
                    </span>
                  </li>
                  <li *ngFor="let output of tx.msg[i].value.outputs" 
                      class="list-group-item d-flex justify-content-between align-items-center">
                    Recipient
                    <span class="badge badge-primary badge-pill"
                          (click)="openTxsListDialog( output.address )"
                          style="cursor: pointer;"> 
                      <span *ngIf="(appState | async).valsMap.size 
                                    ? (appState | async).valsMap.has( output.address ) 
                                    : false; else elseOutputMulti">
                        {{ (appState | async).valsMap.get( output.address )}}
                      </span>
                      <ng-template #elseOutputMulti>{{ output.address }}</ng-template>
                    </span>
                  </li>
                  <li *ngFor="let output of tx.msg[i].value.outputs; index as j" 
                      class="list-group-item d-flex justify-content-between align-items-center">
                    Amount {{j+1}}:
                    <span class="badge badge-primary badge-pill"> 
                      {{ output.coins[0].amount/1e6 | number:".2-2" }}&nbsp;ATOM
                    </span>
                  </li>
                </span>

                <li *ngIf="tx.msg[i].value.amount" 
                    class="list-group-item d-flex justify-content-between align-items-center">
                  Amount
                  <span class="badge badge-primary badge-pill">
                    {{ ( tx.msg[i].value.amount.length ? tx.msg[i].value.amount[0].amount : tx.msg[i].value.amount.amount )/1e6 | number:".2-2" }}&nbsp;ATOM 
                  </span>
                </li>
              </span>
            </ul>
        </mdb-card-body>
      </mdb-card>
    </div>
  </div>
</section>